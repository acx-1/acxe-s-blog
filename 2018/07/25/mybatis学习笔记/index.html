<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Tips：本笔记的内容主要来自传智播客mybatis学习视频的相关资料，以及一些实操后的补充。如有内容或排版方面的错误，欢迎纠正~  Mybatis是什么？&amp;emsp;&amp;emsp;    MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，实质上Mybat">
<meta property="og:type" content="article">
<meta property="og:title" content="mybatis学习笔记">
<meta property="og:url" content="http://yoursite.com/2018/07/25/mybatis学习笔记/index.html">
<meta property="og:site_name" content="Acxer">
<meta property="og:description" content="Tips：本笔记的内容主要来自传智播客mybatis学习视频的相关资料，以及一些实操后的补充。如有内容或排版方面的错误，欢迎纠正~  Mybatis是什么？&amp;emsp;&amp;emsp;    MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，实质上Mybat">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/images/mybatis/mybatis%E6%A1%86%E6%9E%B6%E5%9B%BE.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/4.2user%E8%A1%A8%E7%BB%93%E6%9E%84.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/4.2mybatis%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/mybatis%E4%BE%9D%E8%B5%96%E5%8C%85.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/setting%E9%85%8D%E7%BD%AE1.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/setting%E9%85%8D%E7%BD%AE2.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/7.1.1.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/7.1.2.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/7.1.3.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/7.1.4.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/7.3.1.png">
<meta property="og:image" content="http://yoursite.com/images/mybatis/7.3.2.png">
<meta property="og:updated_time" content="2018-07-27T07:27:31.848Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mybatis学习笔记">
<meta name="twitter:description" content="Tips：本笔记的内容主要来自传智播客mybatis学习视频的相关资料，以及一些实操后的补充。如有内容或排版方面的错误，欢迎纠正~  Mybatis是什么？&amp;emsp;&amp;emsp;    MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，实质上Mybat">
<meta name="twitter:image" content="http://yoursite.com/images/mybatis/mybatis%E6%A1%86%E6%9E%B6%E5%9B%BE.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/07/25/mybatis学习笔记/"/>





  <title>mybatis学习笔记 | Acxer</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Acxer</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">���</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/25/mybatis学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Acxer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Acxer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">mybatis学习笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-25T22:06:14+08:00">
                2018-07-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/框架/" itemprop="url" rel="index">
                    <span itemprop="name">框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>Tips：本笔记的内容主要来自传智播客mybatis学习视频的相关资料，以及一些实操后的补充。如有内容或排版方面的错误，欢迎纠正~</p>
</blockquote>
<h1 id="Mybatis是什么？"><a href="#Mybatis是什么？" class="headerlink" title="Mybatis是什么？"></a>Mybatis是什么？</h1><p>&emsp;&emsp;    MyBatis 本是<a href="http://baike.baidu.com/view/28283.htm" target="_blank" rel="noopener">apache</a>的一个开源项目<a href="http://baike.baidu.com/view/628102.htm" target="_blank" rel="noopener">iBatis</a>, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，实质上Mybatis对ibatis进行一些改进。<br>&emsp;&emsp;    MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装，使开发者只需要关注 SQL 本身，而不需要花费精力去处理例如注册驱动、创建connection、创建statement、手动设置参数、结果集检索等jdbc繁杂的过程代码。<br><a id="more"></a><br>&emsp;&emsp;    Mybatis通过xml或注解的方式将要执行的各种statement（statement、preparedStatemnt、CallableStatement）配置起来，并通过java对象和statement中的sql进行映射生成最终执行的sql语句，最后由mybatis框架执行sql并将结果映射成java对象并返回。</p>
<h1 id="分析原生态jdbc程序中存在的问题"><a href="#分析原生态jdbc程序中存在的问题" class="headerlink" title="分析原生态jdbc程序中存在的问题"></a>分析原生态jdbc程序中存在的问题</h1><h2 id="原生态Jdbc程序代码"><a href="#原生态Jdbc程序代码" class="headerlink" title="原生态Jdbc程序代码"></a>原生态Jdbc程序代码</h2><pre><code>//原生态Jdbc程序代码
public static void** main(String[] args) {
    Connection connection = null;
    PreparedStatement preparedStatement = null;
    ResultSet resultSet = **null**;
    try{
        //1、加载数据库驱动
       Class.forName(&quot;com.mysql.jdbc.Driver&quot;);
        //2、通过驱动管理类获取数据库链接
       connection =DriverManager._getConnection_(&quot;jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8&quot;, &quot;root&quot;, &quot;root&quot;);
       //3、定义sql语句 ?表示占位符
       String sql = &quot;select * from user where username = ?&quot;;    
       //4、获取预处理statement    
       preparedStatement = connection.prepareStatement(sql);    
        //5、设置参数，第一个参数为sql语句中参数的序号（从1开始），第二个参数为设置的参数值    
       preparedStatement.setString(1, &quot;王五&quot;);    
        //6、向数据库发出sql执行查询，查询出结果集    
       resultSet = preparedStatement.executeQuery();   
        //7、遍历查询结果集    
        while(resultSet.next()){
                                      System._out_.println(resultSet.getString(&quot;id&quot;)+&quot;&quot;+resultSet.getString(&quot;username&quot;));    
       }    
   } catch(Exception e) {    
         e.printStackTrace();    
   }finally{    
        //8、释放资源    
        if(resultSet!=null){    
           try{    
               resultSet.close();    
            } catch(SQLException e) {   
                e.printStackTrace();   
            }  
         }    
        if(preparedStatement!=null){    
          try {    
             preparedStatement.close();    
           } catch(SQLException e) {       
               e.printStackTrace();    
           }    
         }    
        if(connection!=null){    
            try{    
               connection.close();    
             } catch (SQLException e) {    
                 e.printStackTrace();    
             }    
         }    
   }    
}
</code></pre><h2 id="Jdbc问题总结"><a href="#Jdbc问题总结" class="headerlink" title="Jdbc问题总结"></a>Jdbc问题总结</h2><ul>
<li>数据库连接频繁开启和关闭，会严重影响数据库的性能。</li>
<li>代码中存在硬编码，分别是数据库部分的硬编码和SQL执行部分的硬编码。</li>
</ul>
<h1 id="Mybatis框架原理（核心）"><a href="#Mybatis框架原理（核心）" class="headerlink" title="Mybatis框架原理（核心）"></a>Mybatis框架原理（核心）</h1><h2 id="框架图"><a href="#框架图" class="headerlink" title="框架图"></a>框架图</h2><p><img src="/images/mybatis/mybatis%E6%A1%86%E6%9E%B6%E5%9B%BE.png" alt="mybatis框架图"></p>
<h2 id="分析结论"><a href="#分析结论" class="headerlink" title="分析结论"></a>分析结论</h2><ol>
<li>mybatis配置文件，包括Mybatis全局配置文件和Mybatis映射文件，其中全局配置文件配置了数据源、事务等信息；映射文件配置了SQL执行相关的信息。</li>
<li>mybatis通过读取配置文件信息（全局配置文件和映射文件），构造出SqlSessionFactory，即会话工厂。</li>
<li>通过SqlSessionFactory，可以创建SqlSession即会话。Mybatis是通过SqlSession来操作数据库的。</li>
<li>SqlSession本身不能直接操作数据库，它是通过底层的Executor执行器接口来操作数据库的。Executor接口有两个实现类，一个是普通执行器，一个是缓存执行器（默认）。</li>
<li>Executor执行器要处理的SQL信息是封装到一个底层对象MappedStatement中。该对象包括：SQL语句、输入参数映射信息、输出结果集映射信息。其中输入参数和输出结果的映射类型包括java的简单类型、HashMap集合对象、POJO对象类型。</li>
</ol>
<h1 id="Mybatis入门程序"><a href="#Mybatis入门程序" class="headerlink" title="Mybatis入门程序"></a>Mybatis入门程序</h1><p>Mybatis课程的所有代码程序将通过一个订单商品案例来进行讲解。</p>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>&emsp;&emsp;  对用户信息的增删改查操作。</p>
<ol>
<li>根据用户ID来查询用户信息；</li>
<li>根据用户名称来模糊查询用户信息列表；</li>
<li>添加用户</li>
<li>删除用户（练习）</li>
<li>修改用户（练习）</li>
</ol>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><ul>
<li>Jdk环境：jdk1.7.0_72</li>
<li>Ide环境：eclipse indigo</li>
<li>数据库环境：MySQL 5.1</li>
<li>Mybatis：3.2.7</li>
</ul>
<h3 id="数据库初始化"><a href="#数据库初始化" class="headerlink" title="数据库初始化"></a>数据库初始化</h3><h4 id="数据库脚本"><a href="#数据库脚本" class="headerlink" title="数据库脚本"></a>数据库脚本</h4><ol>
<li>执行sql_table.sql脚本，创建数据库表；</li>
<li>执行sql_data.sql初始化测试数据。</li>
</ol>
<h4 id="数据库表"><a href="#数据库表" class="headerlink" title="数据库表"></a>数据库表</h4><p>订单商品案例的数据库脚本中，总共包含四张表，其中入门程序只使用user表.<br>用户表的表结构如下：<br><img src="/images/mybatis/4.2user%E8%A1%A8%E7%BB%93%E6%9E%84.png" alt="4.2user表结构"></p>
<h3 id="下载mybatis"><a href="#下载mybatis" class="headerlink" title="下载mybatis"></a>下载mybatis</h3><p>mybaits的代码由github.com管理，下载地址：<a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">https://github.com/mybatis/mybatis-3/releases</a><br><img src="/images/mybatis/4.2mybatis%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84.png" alt="4.2mybatis文件结构"></p>
<ul>
<li>Lib：mybatis的依赖包</li>
<li>Mybatis-3.2.7.jar：mybatis的核心包</li>
<li>Mybatis-3.2.7.pdf：mybatis的使用指南</li>
</ul>
<h2 id="工程搭建（三步）"><a href="#工程搭建（三步）" class="headerlink" title="工程搭建（三步）"></a>工程搭建（三步）</h2><h3 id="第一步：创建java工程"><a href="#第一步：创建java工程" class="headerlink" title="第一步：创建java工程"></a>第一步：创建java工程</h3><p>用eclipse创建一个java工程，jdk使用1.7.0_72。</p>
<h3 id="第二步：加入jar包"><a href="#第二步：加入jar包" class="headerlink" title="第二步：加入jar包"></a>第二步：加入jar包</h3><p>加入以下四部分jar包，其中junit的jar包，是非必须的。</p>
<ul>
<li><p>Mybatis核心包:mybaties-3.2.7.jar</p>
</li>
<li><p>Mybatis依赖包<br><img src="/images/mybatis/mybatis%E4%BE%9D%E8%B5%96%E5%8C%85.png" alt="mybatis依赖包"></p>
</li>
<li><p>MySQL驱动包: mysql-connector-*</p>
</li>
<li><p>Junit单元测试包（单元测试需要的包）:junit-4.9.jar</p>
</li>
</ul>
<h3 id="第三步：添加log4j-properties文件"><a href="#第三步：添加log4j-properties文件" class="headerlink" title="第三步：添加log4j.properties文件"></a>第三步：添加log4j.properties文件</h3><p>Mybatis使用的日志包是log4j的，所以需要添加log4j.properties。<br>在classpath下创建log4j.properties如下：</p>
<pre><code> //文件内容可以从mybatis-3.2.7.pdf中拷贝
 # Global logging configuration
log4j.rootLogger=DEBUG, stdout    
# Console output...
log4j.appender.stdout=org.apache.log4j.ConsoleAppender    
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout    
log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n
</code></pre><ul>
<li>日志级别在开发阶段设置成DEBUG，在生产阶段设置成INFO或者ERROR。</li>
</ul>
<h2 id="编程步骤"><a href="#编程步骤" class="headerlink" title="编程步骤"></a>编程步骤</h2><ol>
<li>创建PO类，根据需求创建；</li>
<li>创建全局配置文件SqlMapConfig.xml；</li>
<li>编写映射文件；</li>
<li>加载映射文件，在SqlMapConfig.xml中进行加载；</li>
<li><p>编写测试程序，即编写Java代码，连接并操作数据库。</p>
<ul>
<li>思路：</li>
</ul>
</li>
<li>读取配置文件；</li>
<li>通过SqlSessionFactoryBuilder创建SqlSessionFactory会话工厂。</li>
<li>通过SqlSessionFactory创建SqlSession。</li>
<li>调用SqlSession的操作数据库方法。</li>
<li>关闭SqlSession。</li>
</ol>
<h2 id="代码开发"><a href="#代码开发" class="headerlink" title="代码开发"></a>代码开发</h2><h3 id="创建PO类"><a href="#创建PO类" class="headerlink" title="创建PO类"></a>创建PO类</h3><p>&emsp; 创建的po类的属性要和数据库中表的列名一致（如果表中的列名是带有下划线，那么po类中对应的的属性名要采用驼峰式命名）<br>&emsp;User.java类如下：</p>
<pre><code>//Public class User {
    private int id;
    private String username;// 用户姓名
    private String sex;// 性别
    private Date birthday;// 生日
    private String address;// 地址
get/set……
</code></pre><h3 id="创建SqlMapConfig-xml配置文件"><a href="#创建SqlMapConfig-xml配置文件" class="headerlink" title="创建SqlMapConfig.xml配置文件"></a>创建SqlMapConfig.xml配置文件</h3><p>&emsp; 在classpath下，创建SqlMapConfig.xml文件</p>
<pre><code>//SqlMapConfig.xml（文件头可以从mybatis-3.2.7.pdf文档的2.1.2小节中拷贝）：
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
&lt;!-- 配置mybatis的环境信息 --&gt;
&lt;environments default=&quot;development&quot;&gt;
    &lt;environment id=&quot;development&quot;&gt;
        &lt;!-- 配置JDBC事务控制，由mybatis进行管理 --&gt;
        &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;
        &lt;!-- 配置数据源，采用dbcp连接池 --&gt;
        &lt;dataSource type=&quot;POOLED&quot;&gt;
            &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
            &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;amp;characterEncoding=utf8&quot;/&gt;
            &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
            &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;
        &lt;/dataSource&gt;
    &lt;/environment&gt;
&lt;/environments&gt;
&lt;/configuration&gt;
</code></pre><h3 id="需求开发"><a href="#需求开发" class="headerlink" title="需求开发"></a>需求开发</h3><p>&emsp;在classpath下，创建sqlmap文件夹。在sqlmap目录下，创建User.xml映射文件。</p>
<pre><code>//Mybatis的映射文件头（可以从mybatis-3.2.7.pdf文件中拷贝）：
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper    
PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;    
&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
</code></pre><h4 id="根据用户ID来查询用户信息"><a href="#根据用户ID来查询用户信息" class="headerlink" title="根据用户ID来查询用户信息"></a>根据用户ID来查询用户信息</h4><h5 id="编写映射文件"><a href="#编写映射文件" class="headerlink" title="编写映射文件"></a>编写映射文件</h5><p>&emsp;在User.xml中添加以下代码：</p>
<pre><code>//&lt;!-- 
    namespace：命名空间，它的作用就是对SQL进行分类化管理，可以理解为SQL隔离
    注意：使用mapper代理开发时，namespace有特殊且重要的作用
 --&gt;
&lt;mapper namespace=&quot;test&quot;&gt;    
    &lt;!-- 根据用户ID，查询用户信息 --&gt;
    &lt;!-- 
        [id]：statement的id，要求在命名空间内唯一  
        [parameterType]：入参的java类型
        [resultType]：查询出的单条结果集对应的java类型
        [#{}]： 表示一个占位符?
        [#{id}]：表示该占位符待接收参数的名称为id。注意：如果参数为简单类型时，#{}里面的参数名称可以是任意定义
     --&gt;
    &lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
        SELECT * FROM USER WHERE id = #{id}
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre><h5 id="加载映射文件"><a href="#加载映射文件" class="headerlink" title="加载映射文件"></a>加载映射文件</h5><pre><code>//在SqlMapConfig.xml中，添加以下代码：
&lt;!-- 加载mapper --&gt;
&lt;mappers&gt;
    &lt;mapper resource=&quot;sqlmap/User.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre><h5 id="编写测试程序"><a href="#编写测试程序" class="headerlink" title="编写测试程序"></a>编写测试程序</h5><pre><code>//public class MybatisFirst {        
        @Test
        public void findUserByIdTest() throws Exception{                
            //1、读取配置文件
            String resource = &quot;SqlMapConfig.xml&quot;;
            InputStream inputStream = Resources.getResourceAsStream(resource);
            //2、根据配置文件创建SqlSessionFactory
            SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
            //3、SqlSessionFactory创建SqlSession
            SqlSession sqlSession = sqlSessionFactory.openSession();
            //4、SqlSession执行statement，并返回映射结果
            //第一个参数：statement的id，建议：namespace.statementId（确保唯一）
            //第二个参数：入参的值，它的类型要和映射文件中对应的statement的入参类型一致
            User user = sqlSession.selectOne(&quot;findUserById&quot;, 1);                
            //打印输出结果集
            System.out.println(user);                
            //5、关闭SqlSession
            sqlSession.close();
        }
    }
</code></pre><h4 id="根据用户名称来模糊查询用户信息列表"><a href="#根据用户名称来模糊查询用户信息列表" class="headerlink" title="根据用户名称来模糊查询用户信息列表"></a>根据用户名称来模糊查询用户信息列表</h4><h5 id="编写映射文件-1"><a href="#编写映射文件-1" class="headerlink" title="编写映射文件"></a>编写映射文件</h5><pre><code>//在User.xml中，添加以下内容
&lt;!-- 根据用户名称模糊查询用户信息列表 --&gt;
&lt;!-- 
    [${}]：表示拼接SQL字符串
    [${value}]：表示要拼接的是简单类型参数。
    注意：
      1、如果参数为简单类型时，${}里面的参数名称必须为value 
      2、${}会引起SQL注入，一般情况下不推荐使用。但是有些场景必须使用${}，比如order by ${colname}
--&gt;
&lt;select id=&quot;findUsersByName&quot; parameterType=&quot;String&quot; resultType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
    SELECT * FROM USER WHERE username LIKE &apos;%${value}%&apos;
&lt;/select&gt;
</code></pre><h5 id="加载映射文件-1"><a href="#加载映射文件-1" class="headerlink" title="加载映射文件"></a>加载映射文件</h5><pre><code>//已配置，此处无需再次配置
</code></pre><h5 id="编写测试程序-1"><a href="#编写测试程序-1" class="headerlink" title="编写测试程序"></a>编写测试程序</h5><pre><code>//@Test
public void findUsersByNameTest() throws Exception {
    // 1、读取配置文件
    String resource = &quot;SqlMapConfig.xml&quot;;
    InputStream inputStream = Resources.getResourceAsStream(resource);
    // 2、根据配置文件创建SqlSessionFactory
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    // 3、SqlSessionFactory创建SqlSession
    SqlSession sqlSession = sqlSessionFactory.openSession();
    // 4、SqlSession执行statement，并返回映射结果
    // 第一个参数：statement的id，建议：namespace.statementId（确保唯一）
    // 第二个参数：入参的值，它的类型要和映射文件中对应的statement的入参类型一致
    List&lt;User&gt; users = sqlSession.selectList(&quot;test.findUsersByName&quot;, &quot;小明&quot;);

    // 打印输出结果集
    System.out.println(users);

    // 5、关闭SqlSession
    sqlSession.close();
}
</code></pre><h4 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h4><h5 id="编写映射文件-2"><a href="#编写映射文件-2" class="headerlink" title="编写映射文件"></a>编写映射文件</h5><pre><code>//&lt;!-- 添加用户 --&gt;
&lt;!-- 如果主键的值是通过MySQL自增机制生成的，那么我们此处不需要再显示的给ID赋值 --&gt;
&lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
    INSERT INTO USER(username,sex,birthday,address) VALUES (#{username},#{sex},#{birthday},#{address})
&lt;/insert&gt;
</code></pre><h5 id="加载映射文件-2"><a href="#加载映射文件-2" class="headerlink" title="加载映射文件"></a>加载映射文件</h5><pre><code>//已配置，此处无需再次配置
</code></pre><h5 id="编写测试程序-2"><a href="#编写测试程序-2" class="headerlink" title="编写测试程序"></a>编写测试程序</h5><pre><code>//注意：增删改操作要对SqlSession执行commit操作。
@Test
    public void insertUserTest() throws Exception {
        // 1、读取配置文件
        String resource = &quot;SqlMapConfig.xml&quot;;
        InputStream inputStream = Resources.getResourceAsStream(resource);
        // 2、根据配置文件创建SqlSessionFactory
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder()
                .build(inputStream);
        // 3、SqlSessionFactory创建SqlSession
        SqlSession sqlSession = sqlSessionFactory.openSession();
        // 4、SqlSession执行statement，并返回映射结果
        //构建user参数，没有赋值的属性采取默认值
        User user = new User();
        user.setUsername(&quot;东哥1&quot;);
        user.setAddress(&quot;清河宝盛西里&quot;);
        // 第一个参数：statement的id，建议：namespace.statementId（确保唯一）
        // 第二个参数：入参的值，它的类型要和映射文件中对应的statement的入参类型一致
        sqlSession.insert(&quot;insertUser&quot;, user);
        //切记：增删改操作时，要执行commit操作
        sqlSession.commit();
        // 5、关闭SqlSession
        sqlSession.close();
    }
</code></pre><h5 id="主键返回之MySQL自增主键"><a href="#主键返回之MySQL自增主键" class="headerlink" title="主键返回之MySQL自增主键"></a>主键返回之MySQL自增主键</h5><p>思路：</p>
<ul>
<li>MySQL自增主键，是指在insert之前MySQL会自动生成一个自增的主键。</li>
<li>我们可以通过MySQL的函数获取到刚插入的自增主键:LAST_INSERT_ID()</li>
<li><p>这个函数是在insert语句之后去调用。</p>
<p>  //修改映射文件：</p>
  <!-- 添加用户之自增主键返回（selectKey方式） -->
  <!-- 
          [selectKey标签]：通过select查询来生成主键
          [keyProperty]：指定存放生成主键的属性
          [resultType]：生成主键所对应的Java类型
          [order]：指定该查询主键SQL语句的执行顺序，相对于insert语句
          [last_insert_id]：MySQL的函数，要配合insert语句一起使用
  -->
  <insert id="insertUser" parametertype="cn.itcast.mybatis.po.User"><br>      <selectkey keyproperty="id" resulttype="int" order="AFTER"><br>          SELECT LAST_INSERT_ID()<br>      </selectkey><br>      INSERT INTO USER(username,sex,birthday,address) VALUES (#{username},#{sex},#{birthday},#{address})<br>  </insert>

</li>
</ul>
<h5 id="主键返回之MySQL函数UUID"><a href="#主键返回之MySQL函数UUID" class="headerlink" title="主键返回之MySQL函数UUID"></a>主键返回之MySQL函数UUID</h5><pre><code>// 注意：使用mysql的uuid()函数生成主键，需要修改表中id字段类型为string，长度设置成35位。
&lt;!-- 添加用户之UUID主键返回 --&gt;
&lt;!-- 
    [uuid]：MySQL的函数，生成的主键是35位的字符串，所以使用它时要修改id的类型为字符类型
    注意：
        1、此时order采用BEFORE，因为需要先生成出主键，再执行insert语句
        2、显式的给ID赋值
--&gt;
&lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
    &lt;selectKey keyProperty=&quot;id&quot; resultType=&quot;string&quot; order=&quot;BEFORE&quot;&gt;
        SELECT UUID()
    &lt;/selectKey&gt;
    INSERT INTO USER(id,username,sex,birthday,address) VALUES (#{id},#{username},#{sex},#{birthday},#{address})
&lt;/insert&gt;
</code></pre><h5 id="主键返回之Oracle序列返回"><a href="#主键返回之Oracle序列返回" class="headerlink" title="主键返回之Oracle序列返回"></a>主键返回之Oracle序列返回</h5><pre><code>//&lt;!-- 添加用户之sequence返回 --&gt;
&lt;!-- 
    通过Oracle的sequence获取主键方式与MySQL的uuid方式基本一致    
--&gt;
&lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
    &lt;selectKey keyProperty=&quot;id&quot; resultType=&quot;int&quot; order=&quot;BEFORE&quot;&gt;
        SELECT user_seq.nextval() FROM dual
    &lt;/selectKey&gt;
    INSERT INTO USER(id,username,sex,birthday,address) VALUES (#{id},#{username},#{sex},#{birthday},#{address})
&lt;/insert&gt;
</code></pre><h4 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h4><h5 id="编写映射文件-3"><a href="#编写映射文件-3" class="headerlink" title="编写映射文件"></a>编写映射文件</h5><pre><code>//&lt;!-- 根据ID删除用户 --&gt;
&lt;delete id=&quot;deleteUser&quot; parameterType=&quot;int&quot;&gt;
    DELETE FROM USER WHERE id= #{id}
&lt;/delete&gt;
</code></pre><h5 id="加载映射文件-3"><a href="#加载映射文件-3" class="headerlink" title="加载映射文件"></a>加载映射文件</h5><pre><code>//已配置，此处无需再次配置。
</code></pre><h5 id="编写测试程序-3"><a href="#编写测试程序-3" class="headerlink" title="编写测试程序"></a>编写测试程序</h5><pre><code>//@Test
public void deleteUserTest() throws Exception{
    // 1、读取配置文件
    String resource = &quot;SqlMapConfig.xml&quot;;
    InputStream inputStream = Resources.getResourceAsStream(resource);
    // 2、根据配置文件创建SqlSessionFactory
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder()
                .build(inputStream);
    // 3、SqlSessionFactory创建SqlSession
    SqlSession sqlSession = sqlSessionFactory.openSession();
    // 4、SqlSession执行statement，并返回映射结果
    // 第一个参数：statement的id，建议：namespace.statementId（确保唯一）
    // 第二个参数：入参的值，它的类型要和映射文件中对应的statement的入参类型一致
    sqlSession.delete(&quot;test.deleteUser&quot;, 30);            
    //切记：增删改操作时，要执行commit操作
    sqlSession.commit();   
    // 5、关闭SqlSession
    sqlSession.close();
}
</code></pre><h4 id="修改用户"><a href="#修改用户" class="headerlink" title="修改用户"></a>修改用户</h4><h5 id="编写映射文件-4"><a href="#编写映射文件-4" class="headerlink" title="编写映射文件"></a>编写映射文件</h5><pre><code>//&lt;!-- 根据传入的用户信息修改用户 --&gt;
&lt;update id=&quot;updateUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
    UPDATE USER SET username = #{username},sex=#{sex} WHERE id=#{id}
&lt;/update&gt;
</code></pre><h5 id="加载映射文件-4"><a href="#加载映射文件-4" class="headerlink" title="加载映射文件"></a>加载映射文件</h5><pre><code>//已配置，此处无需再次配置。
</code></pre><h5 id="编写测试程序-4"><a href="#编写测试程序-4" class="headerlink" title="编写测试程序"></a>编写测试程序</h5><pre><code>//@Test
public void updateUserTest() throws Exception{
    // 1、读取配置文件
    String resource = &quot;SqlMapConfig.xml&quot;;
    InputStream inputStream = Resources.getResourceAsStream(resource);
    // 2、根据配置文件创建SqlSessionFactory
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    // 3、SqlSessionFactory创建SqlSession
    SqlSession sqlSession = sqlSessionFactory.openSession();
    // 4、SqlSession执行statement，并返回映射结果           
    //构建user参数，没有赋值的属性采取默认值
    User user = new User();
    user.setId(28);
    user.setUsername(&quot;东哥11&quot;);
    user.setAddress(&quot;清河宝盛西里&quot;);            
    // 第一个参数：statement的id，建议：namespace.statementId（确保唯一）
    // 第二个参数：入参的值，它的类型要和映射文件中对应的statement的入参类型一致
    sqlSession.update(&quot;test.updateUser&quot;, user);            
    //切记：增删改操作时，要执行commit操作
    sqlSession.commit();    
    // 5、关闭SqlSession
    sqlSession.close();
}
</code></pre><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><h3 id="parameterType和resultType"><a href="#parameterType和resultType" class="headerlink" title="parameterType和resultType"></a>parameterType和resultType</h3><ul>
<li>parameterType指定输入参数的java类型，可以填写别名或Java类的全限定名。</li>
<li>resultType指定输出结果的java类型，可以填写别名或Java类的全限定名。</li>
</ul>
<h3 id="和"><a href="#和" class="headerlink" title="#{}和${}"></a>#{}和${}</h3><ul>
<li>#{}：相当于预处理中的占位符？。</li>
<li>#{}里面的参数表示接收java输入参数的名称。</li>
<li>#{}可以接受HashMap、简单类型、POJO类型的参数。</li>
<li>当接受简单类型的参数时，#{}里面可以是value，也可以是其他。</li>
<li>#{}可以防止SQL注入。</li>
<li>${}：相当于拼接SQL串，对传入的值不做任何解释的原样输出。</li>
<li>${}会引起SQL注入，所以要谨慎使用。</li>
<li>${}可以接受HashMap、简单类型、POJO类型的参数。</li>
<li>当接受简单类型的参数时，${}里面只能是value。</li>
</ul>
<h3 id="selectOne和selectList"><a href="#selectOne和selectList" class="headerlink" title="selectOne和selectList"></a>selectOne和selectList</h3><ul>
<li>selectOne：只能查询0或1条记录，大于1条记录的话，会报错；</li>
<li>selectList：可以查询0或N条记录</li>
</ul>
<h1 id="Mybatis开发dao"><a href="#Mybatis开发dao" class="headerlink" title="Mybatis开发dao"></a>Mybatis开发dao</h1><p>&emsp;&emsp;Mybatis在项目中主要使用的地方就是开发dao（数据访问层），所以下面讲解一下mybatis开发dao的方法。有两种方式：原始dao开发方式、mapper代理开发方式（推荐）。</p>
<h2 id="需求-1"><a href="#需求-1" class="headerlink" title="需求"></a>需求</h2><ol>
<li>根据用户ID来查询用户信息；</li>
<li>根据用户名称来模糊查询用户信息列表；</li>
<li>添加用户； </li>
</ol>
<h2 id="原始dao开发方式"><a href="#原始dao开发方式" class="headerlink" title="原始dao开发方式"></a>原始dao开发方式</h2><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><ul>
<li>程序员需要写dao接口和dao实现类。</li>
</ul>
<h3 id="编程步骤-1"><a href="#编程步骤-1" class="headerlink" title="编程步骤"></a>编程步骤</h3><ol>
<li>根据需求创建po类</li>
<li>编写全局配置文件</li>
<li>根据需求编写映射文件</li>
<li>加载映射文件</li>
<li>编写dao接口</li>
<li>编写dao实现类</li>
<li>编写测试代码</li>
</ol>
<h3 id="程序编写"><a href="#程序编写" class="headerlink" title="程序编写"></a>程序编写</h3><p>&emsp;&emsp;步骤中的1、2、3、4都在入门程序中进行了编写，此处不需要重新编写。</p>
<h4 id="开发dao接口"><a href="#开发dao接口" class="headerlink" title="开发dao接口"></a>开发dao接口</h4><pre><code>//public interface UserDao {       
    public User findUserById(int id);//根据用户ID来查询用户信息        
    public List&lt;User&gt; findUsersByName(String username);//根据用户名称来模糊查询用户信息列表
    public void insertUser(User user);//添加用户
}
</code></pre><h4 id="开发dao实现类"><a href="#开发dao实现类" class="headerlink" title="开发dao实现类"></a>开发dao实现类</h4><h5 id="SqlSession使用范围"><a href="#SqlSession使用范围" class="headerlink" title="SqlSession使用范围"></a>SqlSession使用范围</h5><p>&emsp;&emsp;通过入门程序，大家可以看出，在测试代码中，有大量的重复代码。所以我们第一反应就是想给它抽取出共性的部分，但是SqlSession、SqlSessionFactory、SqlSessionFactoryBuilder有着各自的生命周期，因为这些生命周期的不同，抽取时要有针对性的处理。</p>
<p>&emsp;&emsp;所以在抽取之前，我们先来了解并总结下它们三个的生命周期。</p>
<h6 id="SqlSessionFactoryBuilder"><a href="#SqlSessionFactoryBuilder" class="headerlink" title="SqlSessionFactoryBuilder"></a>SqlSessionFactoryBuilder</h6><p>&emsp;&emsp;它的作用只是通过配置文件创建SqlSessionFactory，所以只要创建出SqlSessionFactory，它就可以销毁了。所以说，它的生命周期是在方法之内。</p>
<h6 id="SqlSessionFactory"><a href="#SqlSessionFactory" class="headerlink" title="SqlSessionFactory"></a>SqlSessionFactory</h6><p>&emsp;&emsp;它的作用是创建SqlSession的工厂，工厂一旦创建，除非应用停掉，不要销毁。<br>所以说它的生命周期是在应用范围内。这里可以通过单例模式来管理它。<br>&emsp;&emsp;在mybatis整合spring之后，最好的处理方式是把SqlSessionFactory交由spring来做单例管理。</p>
<h6 id="SqlSession"><a href="#SqlSession" class="headerlink" title="SqlSession"></a>SqlSession</h6><p>&emsp;&emsp;SqlSession是一个面向用户（程序员）的接口，它的默认实现是DefaultSqlSession。<br>&emsp;&emsp;Mybatis是通过SqlSession来操作数据库的。SqlSession中不仅包含要处理的SQL信息，还包括一些数据信息，所以说它是线程不安全的，因此它最佳的生命周期范围是在方法体之内。</p>
<h5 id="Dao实现类代码"><a href="#Dao实现类代码" class="headerlink" title="Dao实现类代码"></a>Dao实现类代码</h5><ul>
<li>需要向dao实现类中注入SqlSessionFactory，在方法体内通过SqlSessionFactory创建SqlSession</li>
<li><p>要注意SqlSession和SqlSessionFactory的生命周期。</p>
<p>  //public class UserDaoImpl implements UserDao {    </p>
<pre><code>//注入SqlSessionFactory
private SqlSessionFactory sqlSessionFactory;
//使用构造方法来初始化SqlSessionFactory
public UserDaoImpl(SqlSessionFactory sqlSessionFactory){
    this.sqlSessionFactory = sqlSessionFactory;
}        
@Override
public User findUserById(int id) {
    //通过工厂，在方法内部获取SqlSession，这样就可以避免线程不安全
    SqlSession sqlSession = sqlSessionFactory.openSession();
    //返回结果集
    return sqlSession.selectOne(&quot;test.findUserById&quot;, id);
}    
@Override
public List&lt;User&gt; findUsersByName(String username) {
    //通过工厂，在方法内部获取SqlSession，这样就可以避免线程不安全
    SqlSession sqlSession = sqlSessionFactory.openSession();
    return sqlSession.selectList(&quot;test.findUsersByName&quot;, username);
}    
@Override
public void insertUser(User user) {
    //通过工厂，在方法内部获取SqlSession，这样就可以避免线程不安全
    SqlSession sqlSession = sqlSessionFactory.openSession();
    sqlSession.insert(&quot;test.insertUser&quot;, user);
}    
</code></pre><p>  }          </p>
</li>
</ul>
<h5 id="编写测试代码"><a href="#编写测试代码" class="headerlink" title="编写测试代码"></a>编写测试代码</h5><pre><code>//public class UserDaoTest {
    //声明全局的SqlSessionFactory
    private SqlSessionFactory sqlSessionFactory;        
    @Before
    public void setUp() throws Exception {
        // 1、读取配置文件
        String resource = &quot;SqlMapConfig.xml&quot;;
        InputStream inputStream = Resources.getResourceAsStream(resource);
        // 2、根据配置文件创建SqlSessionFactory
        sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    }    
    @Test
    public void testFindUserById() {
        //构造UserDao对象
        UserDao userDao = new UserDaoImpl(sqlSessionFactory);
        //调用UserDao对象的方法
        User user = userDao.findUserById(1);            
        System.out.println(user);
    }   
    @Test
    public void testFindUsersByName() {
        //构造UserDao对象
        UserDao userDao = new UserDaoImpl(sqlSessionFactory);
        //调用UserDao对象的方法
        List&lt;User&gt; list = userDao.findUsersByName(&quot;小明&quot;);            
        System.out.println(list);
    }    
    @Test
    public void testInsertUser() {
        //构造UserDao对象
        UserDao userDao = new UserDaoImpl(sqlSessionFactory);
        //构造User对象
        User user = new User();
        user.setUsername(&quot;东哥3&quot;);
        user.setAddress(&quot;清河宝盛西里3&quot;);            
        //调用UserDao对象的方法
        userDao.insertUser(user);            
        System.out.println(user.getId());
    }    
}
</code></pre><h3 id="问题总结"><a href="#问题总结" class="headerlink" title="问题总结"></a>问题总结</h3><p>&emsp;原始dao开发存在一些问题：</p>
<ul>
<li>存在一定量的模板代码。比如：通过SqlSessionFactory创建SqlSession；调用SqlSession的方法操作数据库；关闭Sqlsession。</li>
<li>存在一些硬编码。调用SqlSession的方法操作数据库时，需要指定statement的id，这里存在了硬编码。</li>
</ul>
<h2 id="Mapper代理开发方式（推荐）"><a href="#Mapper代理开发方式（推荐）" class="headerlink" title="Mapper代理开发方式（推荐）"></a>Mapper代理开发方式（推荐）</h2><p>&emsp;&emsp;Mapper代理的开发方式，程序员只需要编写mapper接口（相当于dao接口）即可。Mybatis会自动的为mapper接口生成动态代理实现类。<br>&emsp;&emsp;不过要实现mapper代理的开发方式，需要遵循一些开发规范。</p>
<h3 id="开发规范"><a href="#开发规范" class="headerlink" title="开发规范"></a>开发规范</h3><ol>
<li>mapper接口的全限定名要和mapper映射文件的namespace的值相同。</li>
<li>mapper接口的方法名称要和mapper映射文件中的statement的id相同；<br>3.mapper接口的方法参数只能有一个，且类型要和mapper映射文件中statement的parameterType的值保持一致。</li>
<li>mapper接口的返回值类型要和mapper映射文件中statement的resultType值或resultMap中的type值保持一致；</li>
</ol>
<p>&emsp;注：通过规范式的开发mapper接口，可以解决原始dao开发当中存在的问题：</p>
<ul>
<li>模板代码已经去掉；</li>
<li>剩下去不掉的操作数据库的代码，其实就是一行代码。这行代码中硬编码的部分，通过第一和第二个规范就可以解决。</li>
</ul>
<h3 id="编程步骤-2"><a href="#编程步骤-2" class="headerlink" title="编程步骤"></a>编程步骤</h3><ol>
<li>根据需求创建po类</li>
<li>编写全局配置文件</li>
<li>根据需求编写映射文件</li>
<li>加载映射文件</li>
<li>编写mapper接口</li>
<li>编写测试代码</li>
</ol>
<h3 id="程序编写-1"><a href="#程序编写-1" class="headerlink" title="程序编写"></a>程序编写</h3><p>&emsp;&emsp;步骤中的1、2都在入门程序中进行了编写，此处不需要重新编写。</p>
<h4 id="编写mapper映射文件"><a href="#编写mapper映射文件" class="headerlink" title="编写mapper映射文件"></a>编写mapper映射文件</h4><p>&emsp;&emsp;重新定义mapper映射文件UserMapper.xml（内容同Users.xml，除了namespace的值），放到新创建的目录mapper下。</p>
<pre><code>//&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper    
PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;    
&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;!-- namespace：此时用mapper代理方式，它的值必须等于对应mapper接口的全限定名  --&gt;
&lt;mapper namespace=&quot;cn.itcast.mybatis.mapper.UserMapper&quot;&gt;    
    &lt;!-- 根据用户ID，查询用户信息 --&gt;
    &lt;!-- 
        [id]：statement的id，要求在命名空间内唯一  
        [parameterType]：入参的java类型，可是是简单类型、POJO、HashMap
        [resultType]：查询出的单条结果集对应的java类型
        [#{}]： 表示一个占位符?
        [#{id}]：表示该占位符待接收参数的名称为id。注意：如果参数为简单类型时，#{}里面的参数名称可以是任意定义
     --&gt;
    &lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
        SELECT * FROM USER WHERE id = #{id}
    &lt;/select&gt;                
    &lt;!-- 根据用户名称模糊查询用户信息列表 --&gt;
    &lt;!-- 
        [${}]：表示拼接SQL字符串，即不加解释的原样输出
         [${value}]：表示要拼接的是简单类型参数。
         注意：
        1、如果参数为简单类型时，${}里面的参数名称必须为value 
        2、${}会引起SQL注入，一般情况下不推荐使用。但是有些场景必须使用${}，比如order by ${colname}
    --&gt;
    &lt;select id=&quot;findUsersByName&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
        SELECT * FROM USER WHERE username LIKE &apos;%${value}%&apos;
    &lt;/select&gt;        
    &lt;!-- 添加用户之自增主键返回（selectKey方式） --&gt;
    &lt;!-- 
        [selectKey标签]：通过select查询来生成主键
        [keyProperty]：指定存放生成主键的属性
        [resultType]：生成主键所对应的Java类型
        [order]：指定该查询主键SQL语句的执行顺序，相对于insert语句，此时选用AFTER
        [last_insert_id]：MySQL的函数，要配合insert语句一起使用
     --&gt;
    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
        &lt;selectKey keyProperty=&quot;id&quot; resultType=&quot;int&quot; order=&quot;AFTER&quot;&gt;
            SELECT LAST_INSERT_ID()
        &lt;/selectKey&gt;
        INSERT INTO USER(username,sex,birthday,address) VALUES (#{username},#{sex},#{birthday},#{address})
    &lt;/insert&gt;        
&lt;/mapper&gt;
</code></pre><h4 id="加载mapper映射文件"><a href="#加载mapper映射文件" class="headerlink" title="加载mapper映射文件"></a>加载mapper映射文件</h4><pre><code>//&lt;!-- 加载mapper --&gt;
&lt;mappers&gt;
    &lt;mapper resource=&quot;sqlmap/User.xml&quot;/&gt;
    &lt;mapper resource=&quot;mapper/UserMapper.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre><h4 id="编写mapper接口"><a href="#编写mapper接口" class="headerlink" title="编写mapper接口"></a>编写mapper接口</h4><p>&emsp;&emsp;内容同UserDao接口一样：</p>
<pre><code>//public interface UserMapper {
    //根据用户ID来查询用户信息
    public User findUserById(int id);
    //根据用户名称来模糊查询用户信息列表
    public List&lt;User&gt; findUsersByName(String username);
    //添加用户
    public void insertUser(User user);
}
</code></pre><h4 id="编写测试代码-1"><a href="#编写测试代码-1" class="headerlink" title="编写测试代码"></a>编写测试代码</h4><pre><code>//public class UserMapperTest {    
    // 声明全局的SqlSessionFactory
    private SqlSessionFactory sqlSessionFactory;    
    @Before
    public void setUp() throws Exception {
        // 1、读取配置文件
        String resource = &quot;SqlMapConfig.xml&quot;;
        InputStream inputStream = Resources.getResourceAsStream(resource);
        // 2、根据配置文件创建SqlSessionFactory
        sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    }    
    @Test
    public void testFindUserById() {
        // 创建SqlSession
        SqlSession sqlSession = sqlSessionFactory.openSession();
        // 通过SqlSession，获取mapper接口的动态代理对象
        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
        // 调用mapper对象的方法
        User user = userMapper.findUserById(1);    
        System.out.println(user);
        // 关闭SqlSession
        sqlSession.close();    
    }    
    @Test
    public void testFindUsersByName() {
        // 创建SqlSession
        SqlSession sqlSession = sqlSessionFactory.openSession();
        // 通过SqlSession，获取mapper接口的动态代理对象
        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
        // 调用mapper对象的方法
        List&lt;User&gt; list = userMapper.findUsersByName(&quot;小明&quot;);    
        System.out.println(list);
        // 关闭SqlSession
        sqlSession.close();
    }    
    @Test
    public void testInsertUser() {
        // 创建SqlSession
        SqlSession sqlSession = sqlSessionFactory.openSession();
        // 通过SqlSession，获取mapper接口的动态代理对象
        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);            
        //构造User对象
        User user = new User();
        user.setUsername(&quot;东哥4&quot;);
        user.setAddress(&quot;清河宝盛西里4&quot;);            
        // 调用mapper对象的方法
        userMapper.insertUser(user);    
        System.out.println(user.getId());            
        //执行SqlSession的commit操作
        sqlSession.commit();
        // 关闭SqlSession
        sqlSession.close();
    }    
}
</code></pre><h1 id="Mybatis全局配置文件"><a href="#Mybatis全局配置文件" class="headerlink" title="Mybatis全局配置文件"></a>Mybatis全局配置文件</h1><p>&emsp;&emsp;SqlMapConfig.xml是mybatis的全局配置文件，它的名称可以是任意命名的。</p>
<h2 id="全部配置内容"><a href="#全部配置内容" class="headerlink" title="全部配置内容"></a>全部配置内容</h2><p>&emsp;SqlMapConfig.xml的配置内容和顺序如下（顺序不能乱）：</p>
<ul>
<li>Properties（属性）</li>
<li>Settings（全局参数设置）</li>
<li>typeAliases（类型别名）</li>
<li>typeHandlers（类型处理器）</li>
<li>objectFactory（对象工厂）</li>
<li>plugins（插件）</li>
<li>environments（环境信息集合）</li>
<li><ul>
<li>environment（单个环境信息）</li>
</ul>
</li>
<li><ul>
<li><ul>
<li>transactionManager（事物）</li>
</ul>
</li>
</ul>
</li>
<li><ul>
<li><ul>
<li>dataSource（数据源）</li>
</ul>
</li>
</ul>
</li>
<li>mappers（映射器）</li>
</ul>
<h2 id="常用配置详解"><a href="#常用配置详解" class="headerlink" title="常用配置详解"></a>常用配置详解</h2><h3 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h3><p>&emsp;SqlMapConfig.xml文件中可以引用java属性文件中的配置信息<br>&emsp;&emsp;db.properties配置信息如下：</p>
<pre><code>//db.driver=com.mysql.jdbc.Driver
db.url=jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEncoding=utf8
db.username=root
db.password=root
</code></pre><p>SqlMapConfig.xml使用properties标签后，如下所示：</p>
<pre><code>//&lt;!-- 通过properties标签，读取java配置文件的内容 --&gt;
&lt;properties resource=&quot;db.properties&quot; /&gt;    
&lt;!-- 配置mybatis的环境信息 --&gt;
&lt;environments default=&quot;development&quot;&gt;
    &lt;environment id=&quot;development&quot;&gt;
        &lt;!-- 配置JDBC事务控制，由mybatis进行管理 --&gt;
        &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;
        &lt;!-- 配置数据源，采用dbcp连接池 --&gt;
        &lt;dataSource type=&quot;POOLED&quot;&gt;
            &lt;property name=&quot;driver&quot; value=&quot;${db.driver}&quot;/&gt;
            &lt;property name=&quot;url&quot; value=&quot;${db.url}&quot;/&gt;
            &lt;property name=&quot;username&quot; value=&quot;${db.username}&quot;/&gt;
            &lt;property name=&quot;password&quot; value=&quot;${db.password}&quot;/&gt;
        &lt;/dataSource&gt;
    &lt;/environment&gt;
&lt;/environments&gt;              
</code></pre><p>&emsp;使用${}，可以引用已经加载的java配置文件中的信息。</p>
<p>&emsp;&emsp;注意：mybatis将按照下面的顺序加载属性：</p>
<ul>
<li>Properties标签体内定义的属性首先被读取</li>
<li>Properties引用的属性会被读取，如果发现上面已经有同名的属性了，那后面会覆盖前面的值</li>
<li>parameterType接收的值会最后被读取，如果发现上面已经有同名的属性了，那后面会覆盖前面的值</li>
</ul>
<p>&emsp;所以说，mybatis读取属性的顺序由高到低分别是：parameterType接收的属性值、properties引用的属性、properties标签内定义的属性。</p>
<h3 id="Settings"><a href="#Settings" class="headerlink" title="Settings"></a>Settings</h3><p>&emsp;&emsp;mybatis全局配置参数，全局参数将会影响mybatis的运行行为。详细如下：</p>
<p><img src="/images/mybatis/setting%E9%85%8D%E7%BD%AE1.png" alt="setting配置1"><br><img src="/images/mybatis/setting%E9%85%8D%E7%BD%AE2.png" alt="setting配置2"></p>
<h3 id="typeAliases"><a href="#typeAliases" class="headerlink" title="typeAliases"></a>typeAliases</h3><p>&emsp;&emsp;别名是使用是为了在映射文件中，更方便的去指定入参和结果集的类型，不再用写很长的一段全限定名。</p>
<h4 id="mybatis支持的别名"><a href="#mybatis支持的别名" class="headerlink" title="mybatis支持的别名"></a>mybatis支持的别名</h4><table>
<thead>
<tr>
<th style="text-align:center">别名</th>
<th style="text-align:center">映射的类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">_byte</td>
<td style="text-align:center">byte</td>
</tr>
<tr>
<td style="text-align:center">_long</td>
<td style="text-align:center">long</td>
</tr>
<tr>
<td style="text-align:center">_short</td>
<td style="text-align:center">short</td>
</tr>
<tr>
<td style="text-align:center">_int</td>
<td style="text-align:center">int</td>
</tr>
<tr>
<td style="text-align:center">_integer</td>
<td style="text-align:center">int</td>
</tr>
<tr>
<td style="text-align:center">_double</td>
<td style="text-align:center">double</td>
</tr>
<tr>
<td style="text-align:center">_float</td>
<td style="text-align:center">float</td>
</tr>
<tr>
<td style="text-align:center">_boolean</td>
<td style="text-align:center">boolean</td>
</tr>
<tr>
<td style="text-align:center">string</td>
<td style="text-align:center">String</td>
</tr>
<tr>
<td style="text-align:center">byte</td>
<td style="text-align:center">Byte</td>
</tr>
<tr>
<td style="text-align:center">long</td>
<td style="text-align:center">Long</td>
</tr>
<tr>
<td style="text-align:center">short</td>
<td style="text-align:center">Short</td>
</tr>
<tr>
<td style="text-align:center">int</td>
<td style="text-align:center">Integer</td>
</tr>
<tr>
<td style="text-align:center">integer</td>
<td style="text-align:center">Integer</td>
</tr>
<tr>
<td style="text-align:center">double</td>
<td style="text-align:center">Double</td>
</tr>
<tr>
<td style="text-align:center">float</td>
<td style="text-align:center">Float</td>
</tr>
<tr>
<td style="text-align:center">boolean</td>
<td style="text-align:center">Boolean</td>
</tr>
<tr>
<td style="text-align:center">date</td>
<td style="text-align:center">Date</td>
</tr>
<tr>
<td style="text-align:center">decimal</td>
<td style="text-align:center">BigDecimal</td>
</tr>
<tr>
<td style="text-align:center">bigdecimal</td>
<td style="text-align:center">BigDecimal</td>
</tr>
</tbody>
</table>
<h4 id="自定义别名"><a href="#自定义别名" class="headerlink" title="自定义别名"></a>自定义别名</h4><p>&emsp;&emsp;SqlMapConfig.xml配置信息如下：</p>
<pre><code>//&lt;!-- 定义别名 --&gt;
    &lt;typeAliases&gt;
        &lt;!-- 单个定义别名 --&gt;
        &lt;typeAlias type=&quot;cn.itcast.mybatis.po.User&quot; alias=&quot;user&quot;/&gt;            
        &lt;!-- 批量定义别名（推荐） --&gt;
        &lt;!-- [name]：指定批量定义别名的类包，别名为类名（首字母大小写都可） --&gt;
        &lt;package name=&quot;cn.itcast.mybatis.po&quot;/&gt;
    &lt;/typeAliases&gt;                
</code></pre><h3 id="mappers"><a href="#mappers" class="headerlink" title="mappers"></a>mappers</h3><h4 id=""><a href="#" class="headerlink" title=""></a><mapper resource="’’/"></mapper></h4><p>&emsp;&emsp;使用相对于类路径的资源<br>&emsp;&emsp;&emsp;如：<mapper resource="sqlmap/User.xml"></mapper></p>
<h4 id="-1"><a href="#-1" class="headerlink" title=""></a><mapper url="’’/"></mapper></h4><p>&emsp;&emsp;使用完全限定路径如：<br>&emsp;&emsp;&emsp;<mapper url="file:///D:\workspace_spingmvc\mybatis_01\config\sqlmap\User.xml"></mapper></p>
<h4 id="1-1-1-3"><a href="#1-1-1-3" class="headerlink" title="1.1.1.3 "></a>1.1.1.3 <mapper class="’’/"></mapper></h4><p>&emsp;&emsp;使用mapper接口的全限定名<br>&emsp;&emsp;&emsp;如：<mapper class="cn.itcast.mybatis.mapper.UserMapper"><br><strong>注意：此种方法要求mapper接口和mapper映射文件要名称相同，且放到同一个目录下;</strong></mapper></p>
<h4 id="1-1-1-4-（推荐）"><a href="#1-1-1-4-（推荐）" class="headerlink" title="1.1.1.4 （推荐）"></a>1.1.1.4 <package name="’’/">（推荐）</package></h4><p>&emsp;&emsp;注册指定包下的所有映射文件<br>&emsp;&emsp;&emsp;如：<package name="cn.itcast.mybatis.mapper"><br><strong>注意：此种方法要求mapper接口和mapper映射文件要名称相同，且放到同一个目录下;</strong></package></p>
<h1 id="Mybatis映射文件（核心）"><a href="#Mybatis映射文件（核心）" class="headerlink" title="Mybatis映射文件（核心）"></a>Mybatis映射文件（核心）</h1><h2 id="输入映射"><a href="#输入映射" class="headerlink" title="输入映射"></a>输入映射</h2><h3 id="ParameterType"><a href="#ParameterType" class="headerlink" title="ParameterType"></a>ParameterType</h3><p>&emsp;&emsp;指定输入参数的java类型，可以使用别名或者类的全限定名。它可以接收简单类型、POJO、HashMap。</p>
<h4 id="传递简单类型"><a href="#传递简单类型" class="headerlink" title="传递简单类型"></a>传递简单类型</h4><p>&emsp;&emsp;参考入门需求：根据用户ID查询用户信息。<br><img src="/images/mybatis/7.1.1.png" alt="7.1.1"></p>
<h4 id="传递POJO对象"><a href="#传递POJO对象" class="headerlink" title="传递POJO对象"></a>传递POJO对象</h4><p>&emsp;&emsp;参考入门需求：添加用户。<br><img src="/images/mybatis/7.1.2.png" alt="7.1.2"></p>
<h4 id="传递POJO包装对象"><a href="#传递POJO包装对象" class="headerlink" title="传递POJO包装对象"></a>传递POJO包装对象</h4><p>&emsp;&emsp;开发中通过pojo传递查询条件 ，查询条件是综合的查询条件，不仅包括用户查询条件还包括其它的查询条件（比如将用户购买商品信息也作为查询条件），这时可以使用包装对象传递输入参数。</p>
<h5 id="需求-2"><a href="#需求-2" class="headerlink" title="需求"></a>需求</h5><p>&emsp;&emsp;综合查询用户信息，需要传入查询条件复杂，比如（用户信息、订单信息、商品信息）。</p>
<h5 id="定义包装对象"><a href="#定义包装对象" class="headerlink" title="定义包装对象"></a>定义包装对象</h5><p>&emsp;&emsp;一般User.java类要和数据表表字段一致，最好不要在这里面添加其他字段，第二天学习mybatis的逆向工程时，会根据表结构，生成po类，如果在po类中扩展字段，此时会被覆盖掉。<br>&emsp;&emsp;所以针对要扩展的po类，我们需要创建一个扩展类，来继承它。<br><img src="/images/mybatis/7.1.3.png" alt="7.1.3"></p>
<p>&emsp;&emsp;定义POJO包装类：<br><img src="/images/mybatis/7.1.4.png" alt="7.1.4"></p>
<h5 id="编写Mapper接口"><a href="#编写Mapper接口" class="headerlink" title="编写Mapper接口"></a>编写Mapper接口</h5><pre><code>//通过包装类来进行复杂的用户信息综合查询    
public List&lt;UserExt&gt; findUserList(UserQueryVO userQueryVO);
</code></pre><h5 id="2-1-1-3-4-编写mapper映射文件"><a href="#2-1-1-3-4-编写mapper映射文件" class="headerlink" title="2.1.1.3.4 编写mapper映射文件"></a>2.1.1.3.4 编写mapper映射文件</h5><pre><code>&lt;!-- 通过包装类来进行复杂的用户信息综合查询 --&gt;    
&lt;select id=_&quot;findUserList&quot;_ parameterType=_&quot;userQueryVO&quot;_ resultType=_&quot;userExt&quot;_&gt; 
 SELECT * FROM USER WHERE sex=#{userExt.sex} AND username LIKE &apos;%${userExt.username}%&apos;    
&lt;/select&gt;  
</code></pre><p> <strong>注意：入参的类型变为UserQueryVO、结果集的类型变为UserExt，#{}里面的参数变为UserQueryVO对象中的userExt属性的sex和username子属性。</strong></p>
<h5 id="2-1-1-3-5-编写测试代码"><a href="#2-1-1-3-5-编写测试代码" class="headerlink" title="2.1.1.3.5 编写测试代码"></a>2.1.1.3.5 编写测试代码</h5><pre><code>//@Test
public void findUserListTest() {
    // 创建SqlSession
    SqlSession sqlSession = sqlSessionFactory.openSession();
    // 通过SqlSession，获取mapper接口的动态代理对象
    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);    
    //构造userQueryVO对象
    UserQueryVO userQueryVO = new UserQueryVO();           
    // 构造UserExt对象
    UserExt userExt = new UserExt();
    userExt.setSex(&quot;1&quot;);
    userExt.setUsername(&quot;小明&quot;);            
    userQueryVO.setUserExt(userExt);    
    // 调用mapper对象的方法
    List&lt;UserExt&gt; list = userMapper.findUserList(userQueryVO);    
    System.out.println(list);
    // 关闭SqlSession
    sqlSession.close();
}
</code></pre><h4 id="传递HashMap（练习）"><a href="#传递HashMap（练习）" class="headerlink" title="传递HashMap（练习）"></a>传递HashMap（练习）</h4><ul>
<li>同传递POJO对象一样，map的key相当于pojo的属性。</li>
</ul>
<h5 id="映射文件"><a href="#映射文件" class="headerlink" title="映射文件"></a>映射文件</h5><pre><code>&lt;!-- 传递hashmap综合查询用户信息 --&gt;    
  &lt;select id=_&quot;findUserByHashmap&quot;_ parameterType=_&quot;hashmap&quot;_ resultType=_&quot;user&quot;_&gt;    
 select * from user where id=#{id} and username like &apos;%${username}%&apos;   
  &lt;/select&gt;          
</code></pre><p>  &emsp;&emsp; 上边红色标注的是hashmap的key。</p>
<h5 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h5><pre><code>Public void testFindUserByHashmap()throws Exception{    
  //获取session    
 SqlSession session = sqlSessionFactory.openSession();    
  //获限mapper接口实例    
 UserMapper userMapper = session.getMapper(UserMapper.class);    
  //构造查询条件Hashmap对象    
 HashMap&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();    
 map.put(&quot;id&quot;, 1);    
 map.put(&quot;username&quot;, &quot;管理员&quot;);   
  //传递Hashmap对象查询用户列表    
 List&lt;User&gt;list = userMapper.findUserByHashmap(map);    
  //关闭session    
 session.close();    
 }
</code></pre><p>&emsp;异常测试：</p>
<ul>
<li>传递的map中的key和sql中解析的key不一致。</li>
<li>测试结果没有报错，只是通过key获取值为空。</li>
</ul>
<h2 id="输出映射"><a href="#输出映射" class="headerlink" title="输出映射"></a>输出映射</h2><h3 id="resultType"><a href="#resultType" class="headerlink" title="resultType"></a>resultType</h3><p>&emsp;&emsp;先看下原先resultType作为输出结果映射时，它的特点，如何再把列名改为别名，看看是否还能不能映射成功。</p>
<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><ul>
<li>使用resultType进行结果映射时，查询的列名和映射的pojo属性名完全一致，该列才能映射成功。</li>
<li>如果查询的列名和映射的pojo属性名全部不一致，则不会创建pojo对象；</li>
<li>如果查询的列名和映射的pojo属性名有一个一致，就会创建pojo对象。</li>
</ul>
<h4 id="输出简单类型"><a href="#输出简单类型" class="headerlink" title="输出简单类型"></a>输出简单类型</h4><p>&emsp;&emsp;当输出结果只有一列时，可以使用ResultType指定简单类型作为输出结果类型。</p>
<h5 id="需求-3"><a href="#需求-3" class="headerlink" title="需求"></a>需求</h5><p> &emsp;&emsp;综合查询用户总数，需要传入查询条件复杂，比如（用户信息、订单信息、商品信息）。</p>
<h5 id="Mapper映射文件"><a href="#Mapper映射文件" class="headerlink" title="Mapper映射文件"></a>Mapper映射文件</h5><pre><code>&lt;!-- 综合查询用户信息总数，需要传入查询条件复杂，比如（用户信息、订单信息、商品信息） --&gt;    
&lt;select id=_&quot;findUsersCount&quot;_ parameterType=_&quot;UserQueryVO&quot;_    
 resultType=_&quot;int&quot;_&gt;    
 SELECT count(1) FROM USER WHERE sex = #{userExt.sex} AND username LIKE &apos;%${userExt.username}%&apos;    
&lt;/select&gt;
</code></pre><h5 id="Mapper接口"><a href="#Mapper接口" class="headerlink" title="Mapper接口"></a>Mapper接口</h5><pre><code>//综合查询用户信息总数。学习：resultType输出简单类型    
public int findUsersCount(UserQueryVO vo);        
</code></pre><h5 id="测试代码-1"><a href="#测试代码-1" class="headerlink" title="测试代码"></a>测试代码</h5><pre><code>//@Test
public void testFindUsersCount() {
    // 创建SqlSession
    SqlSession sqlSession = sqlSessionFactory.openSession();
    // 通过SqlSession，获取mapper接口的动态代理对象
    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);    
    //构造userQueryVO对象
    UserQueryVO userQueryVO = new UserQueryVO();            
    // 构造UserExt对象
    UserExt userExt = new UserExt();
    userExt.setSex(&quot;1&quot;);
    userExt.setUsername(&quot;小明&quot;);           
    userQueryVO.setUserExt(userExt);    
    int count = mapper.findUsersCount(userQueryVO);
    System.out.println(count);    // 关闭SqlSession
    sqlSession.close();
}
</code></pre><h4 id="输出POJO单个对象和列表"><a href="#输出POJO单个对象和列表" class="headerlink" title="输出POJO单个对象和列表"></a>输出POJO单个对象和列表</h4><p><strong>注意：输出单个pojo对象和pojo列表（盛放pojo对象）时，mapper映射文件中的resultType的类型是一样的，mapper接口的方法返回值不同。</strong></p>
<h5 id="Mapper映射文件-1"><a href="#Mapper映射文件-1" class="headerlink" title="Mapper映射文件"></a>Mapper映射文件</h5><p>&emsp;&emsp;Mapper映射文件是同一个</p>
<pre><code>&lt;select id=_&quot;findUsersByName&quot;_ parameterType=_&quot;java.lang.String&quot;_ resultType=_&quot;cn.itcast.mybatis.po.User&quot;_&gt;    
 SELECT * FROM USER WHERE username LIKE &apos;%${value}%&apos;    
&lt;/select&gt;
</code></pre><h5 id="Mapper接口-1"><a href="#Mapper接口-1" class="headerlink" title="Mapper接口"></a>Mapper接口</h5><p>&emsp;&emsp;下面看下mapper接口的不同之处</p>
<ol>
<li><p>输出单个pojo对象</p>
<p> //根据用户名称来模糊查询用户信息<br> public User findUsersByName(String username);</p>
</li>
<li><p>输出pojo列表</p>
<p> //根据用户名称来模糊查询用户信息列表<br>   public List<user> findUsersByName(String username);</user></p>
</li>
</ol>
<ul>
<li>总结：同样的mapper映射文件，返回单个对象和对象列表时，mapper接口在生成动态代理的时候，会根据返回值的类型，决定调用selectOne方法还是selectList方法。</li>
</ul>
<h3 id="resultMap"><a href="#resultMap" class="headerlink" title="resultMap"></a>resultMap</h3><p>&emsp;&emsp;resultMap可以进行高级结果映射（一对一、一对多映射）。</p>
<h4 id="使用方法-1"><a href="#使用方法-1" class="headerlink" title="使用方法"></a>使用方法</h4><p>&emsp;&emsp;如果查询出来的列名和属性名不一致，通过定义一个resultMap将列名和pojo属性名之间作一个映射关系。</p>
<ol>
<li>定义resultMap</li>
<li>使用resultMap作为statement的输出映射类型。</li>
</ol>
<h4 id="需求-4"><a href="#需求-4" class="headerlink" title="需求"></a>需求</h4><p>&emsp;&emsp;把下面SQL的输出结果集进行映射</p>
<pre><code>SELECT id id_,username username_,sex sex_ FROM USER WHERE id = 1
</code></pre><h4 id="Mapper映射文件-2"><a href="#Mapper映射文件-2" class="headerlink" title="Mapper映射文件"></a>Mapper映射文件</h4><p>&emsp;&emsp;定义resultMap：</p>
<pre><code>&lt;!-- 定义resultMap --&gt;    
&lt;!--    
 [id]：定义resultMap的唯一标识   
 [type]：定义该resultMap最终映射的pojo对象    
 [id标签]：映射结果集的唯一标识列，如果是多个字段联合唯一，则定义多个id标签    
 [result标签]：映射结果集的普通列    
 [column]：SQL查询的列名，如果列有别名，则该处填写别名    
 [property]：pojo对象的属性名    
--&gt;    
&lt;resultMap type=_&quot;user&quot;_ id=_&quot;userResultMap&quot;_&gt;    
  &lt;id column=_&quot;id_&quot;_ property=_&quot;id&quot;_/&gt;    
  &lt;result column=_&quot;username_&quot;_ property=_&quot;username&quot;_/&gt;    
  &lt;result column=_&quot;sex_&quot;_ property=_&quot;sex&quot;_/&gt;    
&lt;/resultMap&gt;
</code></pre><p>&emsp;&emsp;定义statement：</p>
<pre><code>&lt;!-- 根据ID查询用户信息（学习resultMap） --&gt;    
&lt;select id=_&quot;findUserByIdResultMap&quot;_ parameterType=_&quot;int&quot;_ resultMap=_&quot;userResultMap&quot;_&gt;    
SELECT id id_,username username_,sex sex_ FROM USER WHERE id = #{id}    
&lt;/select&gt;
</code></pre><h4 id="Mapper接口定义"><a href="#Mapper接口定义" class="headerlink" title="Mapper接口定义"></a>Mapper接口定义</h4><pre><code>//根据ID查询用户信息（学习resultMap）
public User findUserByIdResultMap(int id);
</code></pre><ul>
<li>定义Statement使用resultMap映射结果集时，Mapper接口定义方法的返回值类型为mapper映射文件中resultMap的type类型。</li>
</ul>
<h4 id="测试代码-2"><a href="#测试代码-2" class="headerlink" title="测试代码"></a>测试代码</h4><pre><code>@Test    
public  void findUserByIdResultMapTest() {    
  // 创建SqlSession   
 SqlSession sqlSession = sqlSessionFactory.openSession();    
  // 通过SqlSession，获取mapper接口的动态代理对象    
 UserMapper userMapper = sqlSession.getMapper(UserMapper.**class**);    
  // 调用mapper对象的方法    
 User user = userMapper.findUserByIdResultMap(1);    
 System._out_.println(user);    
  // 关闭SqlSession   
 sqlSession.close();
</code></pre><h2 id="动态SQL（重点）"><a href="#动态SQL（重点）" class="headerlink" title="动态SQL（重点）"></a>动态SQL（重点）</h2><p>*emsp;&emsp;通过Mybatis提供的各种动态标签实现动态拼接sql，使得mapper映射文件在编写SQL时更加灵活，方便。常用动态SQL标签有：if、where、foreach；</p>
<h3 id="If和where"><a href="#If和where" class="headerlink" title="If和where"></a>If和where</h3><ul>
<li><p>If标签：作为判断入参来使用的，如果符合条件，则把if标签体内的SQL拼接上。<br><strong>注意：用if进行判断是否为空时，不仅要判断null，也要判断空字符串‘’；</strong></p>
</li>
<li><p>Where标签：会去掉条件中的第一个and符号。</p>
</li>
</ul>
<h4 id="需求-5"><a href="#需求-5" class="headerlink" title="需求"></a>需求</h4><p>&emsp;&emsp;用户信息综合查询列表和用户信息综合查询总数这两个statement的定义使用动态SQL。</p>
<h4 id="映射文件-1"><a href="#映射文件-1" class="headerlink" title="映射文件"></a>映射文件</h4><pre><code>&lt;!-- 综合查询用户信息，需要传入查询条件复杂，比如（用户信息、订单信息、商品信息） --&gt;   
&lt;select id=_&quot;findUsersByQueryVO&quot;_ parameterType=_&quot;cn.itcast.mybatis.po.QueryUserVO&quot;_    
 resultType=_&quot;User&quot;_&gt;   
 SELECT * FROM USER    
  &lt;where&gt;    
  &lt;if test=_&quot;userExt != null&quot;_&gt;    
  &lt;if test=_&quot;userExt.sex != null and userExt.sex != &apos;&apos;&quot;_&gt;    
 AND sex = #{userExt.sex}    
  &lt;/if&gt;    
  &lt;if test=_&quot;userExt.username != null and userExt.username != &apos;&apos;&quot;_&gt;    
 AND username LIKE &apos;%${userExt.username}%&apos;    
  &lt;/if&gt;    
  &lt;/if&gt;    
  &lt;/where&gt;    
&lt;/select&gt;    
&lt;!-- 综合查询用户信息总数，需要传入查询条件复杂，比如（用户信息、订单信息、商品信息） --&gt;    
&lt;select id=_&quot;findUsersCount&quot;_ parameterType=_&quot;QueryUserVO&quot;_    
 resultType=_&quot;int&quot;_&gt;    
 SELECT count(1) FROM USER    
  &lt;where&gt;    
  &lt;if test=_&quot;userExt != null&quot;_&gt;    
  &lt;if test=_&quot;userExt.sex != null and userExt.sex != &apos;&apos;&quot;_&gt;   
 AND sex = #{userExt.sex}    
  &lt;/if&gt;    
  &lt;if test=_&quot;userExt.username != null and userExt.username != &apos;&apos;&quot;_&gt;    
 AND username LIKE &apos;%${userExt.username}%&apos;    
  &lt;/if&gt;    
  &lt;/if&gt;    
  &lt;/where&gt;    
&lt;/select&gt;
</code></pre><h4 id="Mapper接口-2"><a href="#Mapper接口-2" class="headerlink" title="Mapper接口"></a>Mapper接口</h4><pre><code>//通过包装类来进行复杂的用户信息综合查询    
public List&lt;UserExt&gt; findUserList(UserQueryVO userQueryVO);    
//综合查询用户总数    
public int findUsersCount(UserQueryVO userQueryVO);
</code></pre><h4 id="测试代码-3"><a href="#测试代码-3" class="headerlink" title="测试代码"></a>测试代码</h4><p>&emsp;&emsp;不传用户名：<br><img src="/images/mybatis/7.3.1.png" alt="7.3.1"></p>
<p>&emsp;&emsp;输出的SQL如下（也不包含用户名）：<br><img src="/images/mybatis/7.3.2.png" alt="7.3.2"></p>
<p>&amp;emsp通过测试可以得知，打印出的SQL语句确实会随着条件的满足情况而不一样。</p>
<h1 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h1>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/23/Struts2学习笔记/" rel="next" title="Struts2学习笔记">
                <i class="fa fa-chevron-left"></i> Struts2学习笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Acxer</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Mybatis是什么？"><span class="nav-number">1.</span> <span class="nav-text">Mybatis是什么？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#分析原生态jdbc程序中存在的问题"><span class="nav-number">2.</span> <span class="nav-text">分析原生态jdbc程序中存在的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#原生态Jdbc程序代码"><span class="nav-number">2.1.</span> <span class="nav-text">原生态Jdbc程序代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Jdbc问题总结"><span class="nav-number">2.2.</span> <span class="nav-text">Jdbc问题总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mybatis框架原理（核心）"><span class="nav-number">3.</span> <span class="nav-text">Mybatis框架原理（核心）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#框架图"><span class="nav-number">3.1.</span> <span class="nav-text">框架图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分析结论"><span class="nav-number">3.2.</span> <span class="nav-text">分析结论</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mybatis入门程序"><span class="nav-number">4.</span> <span class="nav-text">Mybatis入门程序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#需求"><span class="nav-number">4.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#环境准备"><span class="nav-number">4.2.</span> <span class="nav-text">环境准备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库初始化"><span class="nav-number">4.2.1.</span> <span class="nav-text">数据库初始化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#数据库脚本"><span class="nav-number">4.2.1.1.</span> <span class="nav-text">数据库脚本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据库表"><span class="nav-number">4.2.1.2.</span> <span class="nav-text">数据库表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#下载mybatis"><span class="nav-number">4.2.2.</span> <span class="nav-text">下载mybatis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#工程搭建（三步）"><span class="nav-number">4.3.</span> <span class="nav-text">工程搭建（三步）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#第一步：创建java工程"><span class="nav-number">4.3.1.</span> <span class="nav-text">第一步：创建java工程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第二步：加入jar包"><span class="nav-number">4.3.2.</span> <span class="nav-text">第二步：加入jar包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三步：添加log4j-properties文件"><span class="nav-number">4.3.3.</span> <span class="nav-text">第三步：添加log4j.properties文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编程步骤"><span class="nav-number">4.4.</span> <span class="nav-text">编程步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码开发"><span class="nav-number">4.5.</span> <span class="nav-text">代码开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建PO类"><span class="nav-number">4.5.1.</span> <span class="nav-text">创建PO类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建SqlMapConfig-xml配置文件"><span class="nav-number">4.5.2.</span> <span class="nav-text">创建SqlMapConfig.xml配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#需求开发"><span class="nav-number">4.5.3.</span> <span class="nav-text">需求开发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#根据用户ID来查询用户信息"><span class="nav-number">4.5.3.1.</span> <span class="nav-text">根据用户ID来查询用户信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#编写映射文件"><span class="nav-number">4.5.3.1.1.</span> <span class="nav-text">编写映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#加载映射文件"><span class="nav-number">4.5.3.1.2.</span> <span class="nav-text">加载映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编写测试程序"><span class="nav-number">4.5.3.1.3.</span> <span class="nav-text">编写测试程序</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#根据用户名称来模糊查询用户信息列表"><span class="nav-number">4.5.3.2.</span> <span class="nav-text">根据用户名称来模糊查询用户信息列表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#编写映射文件-1"><span class="nav-number">4.5.3.2.1.</span> <span class="nav-text">编写映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#加载映射文件-1"><span class="nav-number">4.5.3.2.2.</span> <span class="nav-text">加载映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编写测试程序-1"><span class="nav-number">4.5.3.2.3.</span> <span class="nav-text">编写测试程序</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加用户"><span class="nav-number">4.5.3.3.</span> <span class="nav-text">添加用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#编写映射文件-2"><span class="nav-number">4.5.3.3.1.</span> <span class="nav-text">编写映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#加载映射文件-2"><span class="nav-number">4.5.3.3.2.</span> <span class="nav-text">加载映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编写测试程序-2"><span class="nav-number">4.5.3.3.3.</span> <span class="nav-text">编写测试程序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#主键返回之MySQL自增主键"><span class="nav-number">4.5.3.3.4.</span> <span class="nav-text">主键返回之MySQL自增主键</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#主键返回之MySQL函数UUID"><span class="nav-number">4.5.3.3.5.</span> <span class="nav-text">主键返回之MySQL函数UUID</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#主键返回之Oracle序列返回"><span class="nav-number">4.5.3.3.6.</span> <span class="nav-text">主键返回之Oracle序列返回</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除用户"><span class="nav-number">4.5.3.4.</span> <span class="nav-text">删除用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#编写映射文件-3"><span class="nav-number">4.5.3.4.1.</span> <span class="nav-text">编写映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#加载映射文件-3"><span class="nav-number">4.5.3.4.2.</span> <span class="nav-text">加载映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编写测试程序-3"><span class="nav-number">4.5.3.4.3.</span> <span class="nav-text">编写测试程序</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改用户"><span class="nav-number">4.5.3.5.</span> <span class="nav-text">修改用户</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#编写映射文件-4"><span class="nav-number">4.5.3.5.1.</span> <span class="nav-text">编写映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#加载映射文件-4"><span class="nav-number">4.5.3.5.2.</span> <span class="nav-text">加载映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编写测试程序-4"><span class="nav-number">4.5.3.5.3.</span> <span class="nav-text">编写测试程序</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小结"><span class="nav-number">4.6.</span> <span class="nav-text">小结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#parameterType和resultType"><span class="nav-number">4.6.1.</span> <span class="nav-text">parameterType和resultType</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#和"><span class="nav-number">4.6.2.</span> <span class="nav-text">#{}和${}</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#selectOne和selectList"><span class="nav-number">4.6.3.</span> <span class="nav-text">selectOne和selectList</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mybatis开发dao"><span class="nav-number">5.</span> <span class="nav-text">Mybatis开发dao</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#需求-1"><span class="nav-number">5.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#原始dao开发方式"><span class="nav-number">5.2.</span> <span class="nav-text">原始dao开发方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#思路"><span class="nav-number">5.2.1.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编程步骤-1"><span class="nav-number">5.2.2.</span> <span class="nav-text">编程步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#程序编写"><span class="nav-number">5.2.3.</span> <span class="nav-text">程序编写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#开发dao接口"><span class="nav-number">5.2.3.1.</span> <span class="nav-text">开发dao接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#开发dao实现类"><span class="nav-number">5.2.3.2.</span> <span class="nav-text">开发dao实现类</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#SqlSession使用范围"><span class="nav-number">5.2.3.2.1.</span> <span class="nav-text">SqlSession使用范围</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#SqlSessionFactoryBuilder"><span class="nav-number">5.2.3.2.1.1.</span> <span class="nav-text">SqlSessionFactoryBuilder</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SqlSessionFactory"><span class="nav-number">5.2.3.2.1.2.</span> <span class="nav-text">SqlSessionFactory</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SqlSession"><span class="nav-number">5.2.3.2.1.3.</span> <span class="nav-text">SqlSession</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Dao实现类代码"><span class="nav-number">5.2.3.2.2.</span> <span class="nav-text">Dao实现类代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编写测试代码"><span class="nav-number">5.2.3.2.3.</span> <span class="nav-text">编写测试代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#问题总结"><span class="nav-number">5.2.4.</span> <span class="nav-text">问题总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mapper代理开发方式（推荐）"><span class="nav-number">5.3.</span> <span class="nav-text">Mapper代理开发方式（推荐）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#开发规范"><span class="nav-number">5.3.1.</span> <span class="nav-text">开发规范</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编程步骤-2"><span class="nav-number">5.3.2.</span> <span class="nav-text">编程步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#程序编写-1"><span class="nav-number">5.3.3.</span> <span class="nav-text">程序编写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#编写mapper映射文件"><span class="nav-number">5.3.3.1.</span> <span class="nav-text">编写mapper映射文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加载mapper映射文件"><span class="nav-number">5.3.3.2.</span> <span class="nav-text">加载mapper映射文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编写mapper接口"><span class="nav-number">5.3.3.3.</span> <span class="nav-text">编写mapper接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编写测试代码-1"><span class="nav-number">5.3.3.4.</span> <span class="nav-text">编写测试代码</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mybatis全局配置文件"><span class="nav-number">6.</span> <span class="nav-text">Mybatis全局配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#全部配置内容"><span class="nav-number">6.1.</span> <span class="nav-text">全部配置内容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用配置详解"><span class="nav-number">6.2.</span> <span class="nav-text">常用配置详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Properties"><span class="nav-number">6.2.1.</span> <span class="nav-text">Properties</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Settings"><span class="nav-number">6.2.2.</span> <span class="nav-text">Settings</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#typeAliases"><span class="nav-number">6.2.3.</span> <span class="nav-text">typeAliases</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#mybatis支持的别名"><span class="nav-number">6.2.3.1.</span> <span class="nav-text">mybatis支持的别名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义别名"><span class="nav-number">6.2.3.2.</span> <span class="nav-text">自定义别名</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mappers"><span class="nav-number">6.2.4.</span> <span class="nav-text">mappers</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#"><span class="nav-number">6.2.4.1.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#-1"><span class="nav-number">6.2.4.2.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-3"><span class="nav-number">6.2.4.3.</span> <span class="nav-text">1.1.1.3 </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-4-（推荐）"><span class="nav-number">6.2.4.4.</span> <span class="nav-text">1.1.1.4 （推荐）</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mybatis映射文件（核心）"><span class="nav-number">7.</span> <span class="nav-text">Mybatis映射文件（核心）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#输入映射"><span class="nav-number">7.1.</span> <span class="nav-text">输入映射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ParameterType"><span class="nav-number">7.1.1.</span> <span class="nav-text">ParameterType</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#传递简单类型"><span class="nav-number">7.1.1.1.</span> <span class="nav-text">传递简单类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#传递POJO对象"><span class="nav-number">7.1.1.2.</span> <span class="nav-text">传递POJO对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#传递POJO包装对象"><span class="nav-number">7.1.1.3.</span> <span class="nav-text">传递POJO包装对象</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#需求-2"><span class="nav-number">7.1.1.3.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#定义包装对象"><span class="nav-number">7.1.1.3.2.</span> <span class="nav-text">定义包装对象</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编写Mapper接口"><span class="nav-number">7.1.1.3.3.</span> <span class="nav-text">编写Mapper接口</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-1-3-4-编写mapper映射文件"><span class="nav-number">7.1.1.3.4.</span> <span class="nav-text">2.1.1.3.4 编写mapper映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-1-3-5-编写测试代码"><span class="nav-number">7.1.1.3.5.</span> <span class="nav-text">2.1.1.3.5 编写测试代码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#传递HashMap（练习）"><span class="nav-number">7.1.1.4.</span> <span class="nav-text">传递HashMap（练习）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#映射文件"><span class="nav-number">7.1.1.4.1.</span> <span class="nav-text">映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#测试代码"><span class="nav-number">7.1.1.4.2.</span> <span class="nav-text">测试代码</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输出映射"><span class="nav-number">7.2.</span> <span class="nav-text">输出映射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#resultType"><span class="nav-number">7.2.1.</span> <span class="nav-text">resultType</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法"><span class="nav-number">7.2.1.1.</span> <span class="nav-text">使用方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输出简单类型"><span class="nav-number">7.2.1.2.</span> <span class="nav-text">输出简单类型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#需求-3"><span class="nav-number">7.2.1.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Mapper映射文件"><span class="nav-number">7.2.1.2.2.</span> <span class="nav-text">Mapper映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Mapper接口"><span class="nav-number">7.2.1.2.3.</span> <span class="nav-text">Mapper接口</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#测试代码-1"><span class="nav-number">7.2.1.2.4.</span> <span class="nav-text">测试代码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输出POJO单个对象和列表"><span class="nav-number">7.2.1.3.</span> <span class="nav-text">输出POJO单个对象和列表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Mapper映射文件-1"><span class="nav-number">7.2.1.3.1.</span> <span class="nav-text">Mapper映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Mapper接口-1"><span class="nav-number">7.2.1.3.2.</span> <span class="nav-text">Mapper接口</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#resultMap"><span class="nav-number">7.2.2.</span> <span class="nav-text">resultMap</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-1"><span class="nav-number">7.2.2.1.</span> <span class="nav-text">使用方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#需求-4"><span class="nav-number">7.2.2.2.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mapper映射文件-2"><span class="nav-number">7.2.2.3.</span> <span class="nav-text">Mapper映射文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mapper接口定义"><span class="nav-number">7.2.2.4.</span> <span class="nav-text">Mapper接口定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#测试代码-2"><span class="nav-number">7.2.2.5.</span> <span class="nav-text">测试代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#动态SQL（重点）"><span class="nav-number">7.3.</span> <span class="nav-text">动态SQL（重点）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#If和where"><span class="nav-number">7.3.1.</span> <span class="nav-text">If和where</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#需求-5"><span class="nav-number">7.3.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#映射文件-1"><span class="nav-number">7.3.1.2.</span> <span class="nav-text">映射文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mapper接口-2"><span class="nav-number">7.3.1.3.</span> <span class="nav-text">Mapper接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#测试代码-3"><span class="nav-number">7.3.1.4.</span> <span class="nav-text">测试代码</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#未完待续"><span class="nav-number">8.</span> <span class="nav-text">未完待续</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Acxer</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
